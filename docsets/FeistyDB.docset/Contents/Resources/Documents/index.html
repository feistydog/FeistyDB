<!DOCTYPE html>
<html lang="en">
  <head>
    <title>FeistyDB  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="FeistyDB  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">FeistyDB Docs</a> (99% documented)</p>
        <p class="header-right"><a href="https://github.com/feistydog/FeistyDB"><img src="img/gh.png"/>View on GitHub</a></p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">FeistyDB Reference</a>
        <img id="carat" src="img/carat.png" />
        FeistyDB  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Core.html">Core</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/Database.html">Database</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Database/TransactionType.html">– TransactionType</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Database/RowChangeType.html">– RowChangeType</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Database/StatusParameter.html">– StatusParameter</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Database/FTS5TokenizationReason.html">– FTS5TokenizationReason</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Statement.html">Statement</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Statement/Counter.html">– Counter</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Row.html">Row</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Values.html">Values</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/DatabaseValue.html">DatabaseValue</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/ColumnConvertible.html">ColumnConvertible</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/ParameterBindable.html">ParameterBindable</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/DatabaseSerializable.html">DatabaseSerializable</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Queues.html">Queues</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/DatabaseQueue.html">DatabaseQueue</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/DatabaseQueue/TransactionCompletion.html">– TransactionCompletion</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/DatabaseQueue/SavepointCompletion.html">– SavepointCompletion</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ConcurrentDatabaseQueue.html">ConcurrentDatabaseQueue</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other Enums.html">Other Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/SQLiteResultCode.html">SQLiteResultCode</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SQLiteResultCode/IOErrExtendedResultCode.html">– IOErrExtendedResultCode</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SQLiteResultCode/LockedExtendedResultCode.html">– LockedExtendedResultCode</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SQLiteResultCode/BusyExtendedResultCode.html">– BusyExtendedResultCode</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SQLiteResultCode/CantOpenExtendedResultCode.html">– CantOpenExtendedResultCode</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SQLiteResultCode/CorruptExtendedResultCode.html">– CorruptExtendedResultCode</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SQLiteResultCode/ReadOnlyExtendedResultCode.html">– ReadOnlyExtendedResultCode</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SQLiteResultCode/AbortExtendedResultCode.html">– AbortExtendedResultCode</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SQLiteResultCode/ConstraintExtendedResultCode.html">– ConstraintExtendedResultCode</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SQLiteResultCode/NoticeExtendedResultCode.html">– NoticeExtendedResultCode</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SQLiteResultCode/WarningExtendedResultCode.html">– WarningExtendedResultCode</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SQLiteResultCode/AuthExtendedResultCode.html">– AuthExtendedResultCode</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SQLiteResultCode/OKExtendedResultCode.html">– OKExtendedResultCode</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other Extensions.html">Other Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Extensions/Bool.html">Bool</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Data.html">Data</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Date.html">Date</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Double.html">Double</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Float.html">Float</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Int.html">Int</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Int16.html">Int16</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Int32.html">Int32</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Int64.html">Int64</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Int8.html">Int8</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/NSNull.html">NSNull</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/NSNumber.html">NSNumber</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/String.html">String</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/UInt.html">UInt</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/UInt16.html">UInt16</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/UInt32.html">UInt32</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/UInt64.html">UInt64</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/UInt8.html">UInt8</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/URL.html">URL</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/UUID.html">UUID</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other Protocols.html">Other Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/Error.html">Error</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/FTS5Tokenizer.html">FTS5Tokenizer</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other Structs.html">Other Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Structs/DatabaseError.html">DatabaseError</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/SQLiteError.html">SQLiteError</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other Typealiases.html">Other Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Other Typealiases.html#/s:8FeistyDB24SQLiteDatabaseConnectiona">SQLiteDatabaseConnection</a>
              </li>
              <li class="nav-group-task">
                <a href="Other Typealiases.html#/s:8FeistyDB23SQLitePreparedStatementa">SQLitePreparedStatement</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <h1 id='feistydb' class='heading'>FeistyDB</h1>

<p><a href="https://travis-ci.org/feistydog/FeistyDB"><img src="https://travis-ci.org/feistydog/FeistyDB.svg?branch=master" alt="Build Status"></a></p>

<p>A powerful and performant Swift interface to <a href="https://sqlite.org">SQLite</a> featuring:</p>

<ul>
<li>Type-safe and type-agnostic database values.</li>
<li>Thread-safe wrappers for serialized and concurrent database access.</li>
<li>Full support for transactions and savepoints, custom collation sequences, and custom SQL functions.</li>
</ul>

<p>FeistyDB allows fast, easy database access with robust error handling.  It is not a general-purpose object-relational mapper.</p>
<h2 id='installation' class='heading'>Installation</h2>

<ol>
<li>Clone the <a href="https://github.com/feistydog/FeistyDB">FeistyDB</a> repository.</li>
<li>Run <code>./get-sqlite.sh</code> to get the latest <a href="https://sqlite.org/amalgamation.html">SQLite amalgamation</a> source code.</li>
<li>Open the project, build, and get started in the playground!</li>
</ol>
<h2 id='quick-start' class='heading'>Quick Start</h2>
<pre class="highlight swift"><code><span class="c1">// Create an in-memory database</span>
<span class="k">let</span> <span class="nv">db</span> <span class="o">=</span> <span class="k">try</span> <span class="kt">Database</span><span class="p">()</span>

<span class="c1">// Create a table</span>
<span class="k">try</span> <span class="n">db</span><span class="o">.</span><span class="nf">execute</span><span class="p">(</span><span class="nv">sql</span><span class="p">:</span> <span class="s">"create table t1(a, b);"</span><span class="p">)</span>

<span class="c1">// Insert a row</span>
<span class="k">try</span> <span class="n">db</span><span class="o">.</span><span class="nf">execute</span><span class="p">(</span><span class="nv">sql</span><span class="p">:</span> <span class="s">"insert into t1(a, b) values (?, ?);"</span><span class="p">,</span> 
               <span class="nv">parameterValues</span><span class="p">:</span> <span class="p">[</span><span class="mi">33</span><span class="p">,</span> <span class="s">"lulu"</span><span class="p">])</span>

<span class="c1">// Retrieve the values</span>
<span class="k">try</span> <span class="n">db</span><span class="o">.</span><span class="nf">execute</span><span class="p">(</span><span class="nv">sql</span><span class="p">:</span> <span class="s">"select a, b from t1;"</span><span class="p">)</span> <span class="p">{</span> <span class="n">row</span> <span class="k">in</span>
    <span class="k">let</span> <span class="nv">a</span><span class="p">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="k">try</span> <span class="n">row</span><span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="nv">at</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">b</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="k">try</span> <span class="n">row</span><span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="nv">at</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>

<p>Most applications should not create a <code><a href="Classes/Database.html">Database</a></code> directly but instead should use the thread-safe <code><a href="Classes/DatabaseQueue.html">DatabaseQueue</a></code> wrapper.</p>
<pre class="highlight swift"><code><span class="c1">// Create a queue serializing access to an in-memory database</span>
<span class="k">let</span> <span class="nv">dbQ</span> <span class="o">=</span> <span class="k">try</span> <span class="kt">DatabaseQueue</span><span class="p">()</span>

<span class="c1">// Perform a synchronous database operation</span>
<span class="k">try</span> <span class="n">dbQ</span><span class="o">.</span><span class="n">sync</span> <span class="p">{</span> <span class="n">db</span> <span class="k">in</span>
    <span class="c1">// Do something with `db`</span>
<span class="p">}</span>
</code></pre>
<h2 id='design' class='heading'>Design</h2>

<p>The core of FeistyDB is the types <code><a href="Classes/Database.html">Database</a></code>, <code><a href="Classes/Statement.html">Statement</a></code>, and <code><a href="Classes/Row.html">Row</a></code>.</p>

<ul>
<li><p><code><a href="Classes/Database.html">Database</a></code> is an SQLite database.</p></li>
<li><p><code><a href="Classes/Statement.html">Statement</a></code> is a compiled SQL statement.</p></li>
<li><p><code><a href="Classes/Row.html">Row</a></code> is a single result row.</p></li>
</ul>

<p>The fundamental type for native database values is <code><a href="Enums/DatabaseValue.html">DatabaseValue</a></code>.</p>

<ul>
<li><code><a href="Enums/DatabaseValue.html">DatabaseValue</a></code> contains an integer, floating-point, textual, or blob value.</li>
</ul>

<p>Type-safe access to database values is provided by classes implementing the <code><a href="Protocols/ColumnConvertible.html">ColumnConvertible</a></code> protocol.</p>

<ul>
<li><code><a href="Protocols/ColumnConvertible.html">ColumnConvertible</a></code> is a type that can be initialized from a column in a result row.</li>
</ul>

<p>SQL parameter binding is provided by classes implementing the <code><a href="Protocols/ParameterBindable.html">ParameterBindable</a></code> protocol.</p>

<ul>
<li><code><a href="Protocols/ParameterBindable.html">ParameterBindable</a></code> is a type that can bind its value to an SQL parameter.</li>
</ul>

<p>General object storage is provided by classes implementing the <code><a href="Protocols/DatabaseSerializable.html">DatabaseSerializable</a></code> protocol.</p>

<ul>
<li><code><a href="Protocols/DatabaseSerializable.html">DatabaseSerializable</a></code> is a type that can be serialized to and deserialized from a database column.</li>
</ul>

<p>Thread-safe access to a database is provided by <code><a href="Classes/DatabaseQueue.html">DatabaseQueue</a></code> and <code><a href="Classes/ConcurrentDatabaseQueue.html">ConcurrentDatabaseQueue</a></code>.</p>

<ul>
<li><p><code><a href="Classes/DatabaseQueue.html">DatabaseQueue</a></code> serializes work items on a database.</p></li>
<li><p><code><a href="Classes/ConcurrentDatabaseQueue.html">ConcurrentDatabaseQueue</a></code> serializes write access to a database but allows concurrent reads.</p></li>
</ul>
<h2 id='examples' class='heading'>Examples</h2>
<h3 id='create-an-in-memory-database' class='heading'>Create an in-memory database</h3>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">db</span> <span class="o">=</span> <span class="k">try</span> <span class="kt">Database</span><span class="p">()</span>
</code></pre>

<p>This creates a database for use on a single thread or queue.</p>
<h3 id='create-a-table' class='heading'>Create a table</h3>
<pre class="highlight swift"><code><span class="k">try</span> <span class="n">db</span><span class="o">.</span><span class="nf">execute</span><span class="p">(</span><span class="nv">sql</span><span class="p">:</span> <span class="s">"create table t1(a, b);"</span><span class="p">)</span>
</code></pre>

<p>The created table <code>t1</code> has two columns, <code>a</code> and <code>b</code>.</p>
<h3 id='insert-data' class='heading'>Insert data</h3>
<pre class="highlight swift"><code><span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">0</span><span class="o">..&lt;</span><span class="mi">5</span> <span class="p">{</span>
    <span class="k">try</span> <span class="n">db</span><span class="o">.</span><span class="nf">execute</span><span class="p">(</span><span class="nv">sql</span><span class="p">:</span> <span class="s">"insert into t1(a, b) values (?, ?);"</span><span class="p">,</span>
                   <span class="nv">parameterValues</span><span class="p">:</span> <span class="p">[</span><span class="mf">2*</span><span class="n">i</span><span class="p">,</span> <span class="mf">2*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="p">}</span>
</code></pre>

<p>SQL parameters are passed as a sequence or series of values.  Named parameters are also supported.</p>
<pre class="highlight swift"><code><span class="k">try</span> <span class="n">db</span><span class="o">.</span><span class="nf">execute</span><span class="p">(</span><span class="nv">sql</span><span class="p">:</span> <span class="s">"insert into t1(a, b) values (:a, :b);"</span><span class="p">,</span>
               <span class="nv">parameters</span><span class="p">:</span> <span class="p">[</span><span class="s">":a"</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s">":b"</span><span class="p">:</span> <span class="mi">404</span><span class="p">])</span>
</code></pre>
<h3 id='insert-data-efficiently' class='heading'>Insert data efficiently</h3>

<p>Rather than parsing SQL each time a statement is executed, it is more efficient to prepare a statement and reuse it.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">s</span> <span class="o">=</span> <span class="k">try</span> <span class="n">db</span><span class="o">.</span><span class="nf">prepare</span><span class="p">(</span><span class="nv">sql</span><span class="p">:</span> <span class="s">"insert into t1(a, b) values (?, ?);"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">0</span><span class="o">..&lt;</span><span class="mi">5</span> <span class="p">{</span>
    <span class="k">try</span> <span class="n">s</span><span class="o">.</span><span class="nf">bind</span><span class="p">(</span><span class="nv">parameterValues</span><span class="p">:</span> <span class="p">[</span><span class="mf">2*</span><span class="n">i</span><span class="p">,</span> <span class="mf">2*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">try</span> <span class="n">s</span><span class="o">.</span><span class="nf">execute</span><span class="p">()</span>
    <span class="k">try</span> <span class="n">s</span><span class="o">.</span><span class="nf">reset</span><span class="p">()</span>
    <span class="k">try</span> <span class="n">s</span><span class="o">.</span><span class="nf">clearBindings</span><span class="p">()</span>
<span class="p">}</span>
</code></pre>
<h3 id='fetch-data' class='heading'>Fetch data</h3>

<p>The closure passed to <code>execute()</code> will be called with each result row.</p>
<pre class="highlight swift"><code><span class="k">try</span> <span class="n">db</span><span class="o">.</span><span class="nf">execute</span><span class="p">(</span><span class="nv">sql</span><span class="p">:</span> <span class="s">"select * from t1;"</span><span class="p">)</span> <span class="p">{</span> <span class="n">row</span> <span class="k">in</span>
    <span class="k">let</span> <span class="nv">x</span><span class="p">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="k">try</span> <span class="n">row</span><span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="nv">at</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">y</span><span class="p">:</span> <span class="kt">Int</span><span class="p">?</span> <span class="o">=</span> <span class="k">try</span> <span class="n">row</span><span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="nv">at</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>

<p><code>row</code> is a <code><a href="Classes/Row.html">Row</a></code> instance.</p>
<h3 id='custom-sql-functions' class='heading'>Custom SQL Functions</h3>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">rot13Mapping</span><span class="p">:</span> <span class="p">[</span><span class="kt">Character</span><span class="p">:</span> <span class="kt">Character</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">"A"</span><span class="p">:</span> <span class="s">"N"</span><span class="p">,</span> <span class="s">"B"</span><span class="p">:</span> <span class="s">"O"</span><span class="p">,</span> <span class="s">"C"</span><span class="p">:</span> <span class="s">"P"</span><span class="p">,</span> <span class="s">"D"</span><span class="p">:</span> <span class="s">"Q"</span><span class="p">,</span> <span class="s">"E"</span><span class="p">:</span> <span class="s">"R"</span><span class="p">,</span> <span class="s">"F"</span><span class="p">:</span> <span class="s">"S"</span><span class="p">,</span> <span class="s">"G"</span><span class="p">:</span> <span class="s">"T"</span><span class="p">,</span> <span class="s">"H"</span><span class="p">:</span> <span class="s">"U"</span><span class="p">,</span> <span class="s">"I"</span><span class="p">:</span> <span class="s">"V"</span><span class="p">,</span> <span class="s">"J"</span><span class="p">:</span> <span class="s">"W"</span><span class="p">,</span> <span class="s">"K"</span><span class="p">:</span> <span class="s">"X"</span><span class="p">,</span> <span class="s">"L"</span><span class="p">:</span> <span class="s">"Y"</span><span class="p">,</span> <span class="s">"M"</span><span class="p">:</span> <span class="s">"Z"</span><span class="p">,</span>
    <span class="s">"N"</span><span class="p">:</span> <span class="s">"A"</span><span class="p">,</span> <span class="s">"O"</span><span class="p">:</span> <span class="s">"B"</span><span class="p">,</span> <span class="s">"P"</span><span class="p">:</span> <span class="s">"C"</span><span class="p">,</span> <span class="s">"Q"</span><span class="p">:</span> <span class="s">"D"</span><span class="p">,</span> <span class="s">"R"</span><span class="p">:</span> <span class="s">"E"</span><span class="p">,</span> <span class="s">"S"</span><span class="p">:</span> <span class="s">"F"</span><span class="p">,</span> <span class="s">"T"</span><span class="p">:</span> <span class="s">"G"</span><span class="p">,</span> <span class="s">"U"</span><span class="p">:</span> <span class="s">"H"</span><span class="p">,</span> <span class="s">"V"</span><span class="p">:</span> <span class="s">"I"</span><span class="p">,</span> <span class="s">"W"</span><span class="p">:</span> <span class="s">"J"</span><span class="p">,</span> <span class="s">"X"</span><span class="p">:</span> <span class="s">"K"</span><span class="p">,</span> <span class="s">"Y"</span><span class="p">:</span> <span class="s">"L"</span><span class="p">,</span> <span class="s">"Z"</span><span class="p">:</span> <span class="s">"M"</span><span class="p">,</span>
    <span class="s">"a"</span><span class="p">:</span> <span class="s">"n"</span><span class="p">,</span> <span class="s">"b"</span><span class="p">:</span> <span class="s">"o"</span><span class="p">,</span> <span class="s">"c"</span><span class="p">:</span> <span class="s">"p"</span><span class="p">,</span> <span class="s">"d"</span><span class="p">:</span> <span class="s">"q"</span><span class="p">,</span> <span class="s">"e"</span><span class="p">:</span> <span class="s">"r"</span><span class="p">,</span> <span class="s">"f"</span><span class="p">:</span> <span class="s">"s"</span><span class="p">,</span> <span class="s">"g"</span><span class="p">:</span> <span class="s">"t"</span><span class="p">,</span> <span class="s">"h"</span><span class="p">:</span> <span class="s">"u"</span><span class="p">,</span> <span class="s">"i"</span><span class="p">:</span> <span class="s">"v"</span><span class="p">,</span> <span class="s">"j"</span><span class="p">:</span> <span class="s">"w"</span><span class="p">,</span> <span class="s">"k"</span><span class="p">:</span> <span class="s">"x"</span><span class="p">,</span> <span class="s">"l"</span><span class="p">:</span> <span class="s">"y"</span><span class="p">,</span> <span class="s">"m"</span><span class="p">:</span> <span class="s">"z"</span><span class="p">,</span>
    <span class="s">"n"</span><span class="p">:</span> <span class="s">"a"</span><span class="p">,</span> <span class="s">"o"</span><span class="p">:</span> <span class="s">"b"</span><span class="p">,</span> <span class="s">"p"</span><span class="p">:</span> <span class="s">"c"</span><span class="p">,</span> <span class="s">"q"</span><span class="p">:</span> <span class="s">"d"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">:</span> <span class="s">"e"</span><span class="p">,</span> <span class="s">"s"</span><span class="p">:</span> <span class="s">"f"</span><span class="p">,</span> <span class="s">"t"</span><span class="p">:</span> <span class="s">"g"</span><span class="p">,</span> <span class="s">"u"</span><span class="p">:</span> <span class="s">"h"</span><span class="p">,</span> <span class="s">"v"</span><span class="p">:</span> <span class="s">"i"</span><span class="p">,</span> <span class="s">"w"</span><span class="p">:</span> <span class="s">"j"</span><span class="p">,</span> <span class="s">"x"</span><span class="p">:</span> <span class="s">"k"</span><span class="p">,</span> <span class="s">"y"</span><span class="p">:</span> <span class="s">"l"</span><span class="p">,</span> <span class="s">"z"</span><span class="p">:</span> <span class="s">"m"</span><span class="p">]</span>

<span class="k">try</span> <span class="n">db</span><span class="o">.</span><span class="nf">addFunction</span><span class="p">(</span><span class="s">"rot13"</span><span class="p">,</span> <span class="nv">arity</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="n">values</span> <span class="k">in</span>
    <span class="k">let</span> <span class="nv">value</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">unsafelyUnwrapped</span>
    <span class="k">switch</span> <span class="n">value</span> <span class="p">{</span>
        <span class="k">case</span> <span class="o">.</span><span class="nf">text</span><span class="p">(</span><span class="k">let</span> <span class="nv">s</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">.</span><span class="nf">text</span><span class="p">(</span><span class="kt">String</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">rot13Mapping</span><span class="p">[</span><span class="nv">$0</span><span class="p">]</span> <span class="p">??</span> <span class="nv">$0</span> <span class="p">}))</span>
        <span class="k">default</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><code>rot13()</code> can now be used just like any other <a href="https://www.sqlite.org/lang_corefunc.html">SQL function</a>.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">s</span> <span class="o">=</span> <span class="k">try</span> <span class="n">db</span><span class="o">.</span><span class="nf">prepare</span><span class="p">(</span><span class="nv">sql</span><span class="p">:</span> <span class="s">"insert into t1(a) values (rot13(?));"</span><span class="p">)</span>
</code></pre>
<h3 id='create-a-queue-for-serialized-database-access' class='heading'>Create a queue for serialized database access</h3>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">dbQ</span> <span class="o">=</span> <span class="k">try</span> <span class="kt">DatabaseQueue</span><span class="p">()</span>
</code></pre>

<p>This creates a queue which may be used from multiple threads safely.  The queue serializes access to the database ensuring only a single operation occurs at a time.</p>
<h3 id='execute-a-synchronous-database-operation' class='heading'>Execute a synchronous database operation</h3>

<p>The closure passed to <code>sync()</code> will be executed synchronously.</p>
<pre class="highlight swift"><code><span class="k">try</span> <span class="n">dbQ</span><span class="o">.</span><span class="n">sync</span> <span class="p">{</span> <span class="n">db</span> <span class="k">in</span>
    <span class="c1">// Do something with db</span>
<span class="p">}</span>
</code></pre>

<p><code>db</code> is a <code><a href="Classes/Database.html">Database</a></code> instance.</p>
<h2 id='license' class='heading'>License</h2>

<p>FeistyDB is released under the <a href="https://github.com/feistydog/FeistyDB/blob/master/LICENSE.txt">MIT License</a>.</p>

          </section>
        </section>
        <section id="footer">
          <p>© 2015 - 2018 <a class="link" href="https://www.feisty-dog.com" target="_blank" rel="external">Feisty Dog, LLC</a> under the <a class="link" href="https://github.com/feistydog/FeistyDB/blob/master/LICENSE.txt" target="_blank" rel="external">MIT License</a>.</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.9.1</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
